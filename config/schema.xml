<?xml version="1.0" encoding="UTF-8"?>
<database name="hhc" defaultIdMethod="native" namespace="hhc\DB">
  <table name="hero" phpName="Hero">
    <column name="id" type="integer" required="true" primaryKey="true" autoIncrement="true" />
    <column name="name" type="varchar" size="50" required="true" />
    <column name="role" type="varchar" size="200" required="true" />
    <column name="hp" type="integer" required="true" phpName="HP" />
    <column name="dmg" type="varchar" size="20" required="true" />
    <column name="armor" type="float" size="4" scale="2" required="true" />
    <column name="difficulty" type="float" size="3" scale="1" required="true" />
    <column name="range" type="integer" required="true" />
    <column name="speed" type="integer" required="true" />
    <column name="stuns" type="integer" required="false" />
  </table>
  <table name="votes" phpName="Votes">
    <column name="hero_name" type="varchar" size="50" required="true" primaryKey="true" phpName="HeroName" />
    <column name="counter_name" type="varchar" size="50" required="true" primaryKey="true" phpName="CounterName" />
    <column name="votes" type="integer" required="false" default="0" />
  </table>
  <table name="user_votes" phpName="UserVotes">
    <column name="id" type="integer" required="true" primaryKey="true" autoIncrement="true" />
    <column name="user_id" type="integer" required="true" />
    <column name="hero_name" type="varchar" size="50" required="true" phpName="HeroName" />
    <column name="counter_name" type="varchar" size="50" required="true" phpName="CounterName" />
    <foreign-key foreignTable="user" phpName="User" refPhpName="UserVotes">
      <reference local="user_id" foreign="id" />
    </foreign-key>
  </table>
  <table name="user" phpName="User">
    <column name="id" type="integer" required="true" primaryKey="true" autoIncrement="true" />
    <column name="username" type="varchar" size="255" required="true" />
    <column name="email" type="varchar" size="255" required="true" />
    <column name="password" type="varchar" size="255" />
    <column name="roles" type="varchar" size="255" default="USER_ROLE" />
    <unique name="unique_username">
        <unique-column name="username" />
    </unique>
    <validator column="username">
        <rule name="unique" message="Username already exists!" />
    </validator>
    <validator column="email">
        <rule name="unique" message="E-mail already exists!" />
        <rule name="match"
            value="/^([a-zA-Z0-9])+([\.a-zA-Z0-9_-])*@([a-zA-Z0-9])+(\.[a-zA-Z0-9_-]+)+$/"
            message="Please enter a valid email address." />
    </validator>
  </table>
</database>
